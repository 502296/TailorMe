<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>Pickup Signature</title>

  <link rel="stylesheet" href="appointment.css">

  <script src="signature.js"></script>

</head>

<body>

  <div class="form-container">

    <h1>Pickup Signature</h1>

    <form id="pickupForm" method="post">

      <label for="customer_name">Name:</label>

      <input type="text" id="customer_name" name="customer_name" required>



      <label for="phone">Phone:</label>

      <input type="tel" id="phone" name="phone" required>



      <label for="number_of_items">Number of Items:</label>

      <input type="number" id="number_of_items" name="number_of_items" required>



      <label for="service_type">Service Type:</label>

      <select id="service_type" name="service_type" required>

        <option value="Alteration">Alteration</option>

        <option value="Tailoring">Tailoring</option>

      </select>



      <label for="pickup_datetime">Pickup Date & Time:</label>

      <input type="datetime-local" id="pickup_datetime" name="pickup_datetime" required>



      <label for="signature">Signature:</label>

      <canvas id="signature-pad" width="300" height="100" style="border:1px solid #ccc;"></canvas><br>

      <button type="button" onclick="clearSignature()">Clear</button>



      <input type="hidden" name="pickup_signature" id="pickup_signature">



      <br><br>

      <button type="submit">Save</button>

    </form>

  </div>



  <script>

    const canvas = document.getElementById("signature-pad");

    const ctx = canvas.getContext("2d");

    let drawing = false;



    canvas.addEventListener("mousedown", () => drawing = true);

    canvas.addEventListener("mouseup", () => drawing = false);

    canvas.addEventListener("mouseout", () => drawing = false);

    canvas.addEventListener("mousemove", draw);



    function draw(e) {

      if (!drawing) return;

      ctx.lineWidth = 2;

      ctx.lineCap = "round";

      const rect = canvas.getBoundingClientRect();

      ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);

      ctx.stroke();

      ctx.beginPath();

      ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);

    }



    function clearSignature() {

      ctx.clearRect(0, 0, canvas.width, canvas.height);

    }



    document.getElementById("pickupForm").addEventListener("submit", function (e) {

      e.preventDefault();

      const signatureData = canvas.toDataURL();

      document.getElementById("pickup_signature").value = signatureData;



      const formData = new FormData(this);



      fetch("save_pickup.php", {

        method: "POST",

        body: formData

      })

        .then(response => response.text())

        .then(result => {

          alert(result);

          this.reset();

          clearSignature();

        })

        .catch(error => {

          alert("Error: " + error);

        });

    });

  </script>

</body>

</html>
