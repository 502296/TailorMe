<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>Pickup Signature</title>

  <link rel="stylesheet" href="appointment.css">

  <script>

    function clearSignature() {

      const canvas = document.getElementById('signatureCanvas');

      const ctx = canvas.getContext('2d');

      ctx.clearRect(0, 0, canvas.width, canvas.height);

    }



    function submitForm(event) {

      event.preventDefault();



      const name = document.getElementById("customer_name").value;

      const phone = document.getElementById("phone").value;

      const service = document.getElementById("service").value;

      const pieces = document.getElementById("pieces").value;

      const pickup_date = document.getElementById("pickup_date").value;

      const pickup_time = document.getElementById("pickup_time").value;

      const notes = document.getElementById("notes").value;



      const canvas = document.getElementById("signatureCanvas");

      const signature = canvas.toDataURL();



      const formData = new FormData();

      formData.append("name", name);

      formData.append("phone", phone);

      formData.append("service", service);

      formData.append("pieces", pieces);

      formData.append("pickup_date", pickup_date);

      formData.append("pickup_time", pickup_time);

      formData.append("notes", notes);

      formData.append("signature", signature);



     fetch("https://script.google.com/macros/s/AKfycwbur0gDuM-jPLWXQUWVi-XBsTd66bAZPYnmNk1oCRJGtbfqq5F9B7jjNAYDfFa1PaeV/exec", {

        method: "POST",

        body: formData

      })

      .then(res => res.text())

      .then(data => {

        alert("✅ Submitted successfully!");

        document.getElementById("pickupForm").reset();

        clearSignature();

      })

      .catch(err => {

        console.error("Error!", err.message);

        alert("❌ Submission failed.");

      });

    }

  </script>

</head>

<body>

  <div class="form-container">

    <h1>Pickup Signature</h1>

    <form id="pickupForm" onsubmit="submitForm(event)">

      <label for="customer_name">Name:</label>

      <input type="text" id="customer_name" name="name" required>



      <label for="phone">Phone:</label>

      <input type="tel" id="phone" name="phone" required>



      <label for="service">Service Type:</label>

      <select id="service" name="service" required>

        <option value="Tailoring">Tailoring</option>

        <option value="Alteration">Alteration</option>

      </select>



      <label for="pieces">Number of Pieces:</label>

      <input type="number" id="pieces" name="pieces" required>



      <label for="pickup_date">Pickup Date:</label>

      <input type="date" id="pickup_date" name="pickup_date" required>



      <label for="pickup_time">Pickup Time:</label>

      <input type="time" id="pickup_time" name="pickup_time" required>



      <label for="notes">Notes (optional):</label>

      <textarea id="notes" name="notes"></textarea>



      <label for="signature">Signature:</label>

      <canvas id="signatureCanvas" width="300" height="150" style="border:1px solid #ccc; background-color:white;"></canvas>

      <br>

      <button type="button" onclick="clearSignature()">Clear Signature</button>



      <br><br>

      <button type="submit">Submit</button>

      <a href="appointment.html" class="back-button">Back</a>

    </form>

  </div>



  <script>

    const canvas = document.getElementById('signatureCanvas');

    const ctx = canvas.getContext('2d');

    let drawing = false;



    canvas.addEventListener('mousedown', () => drawing = true);

    canvas.addEventListener('mouseup', () => drawing = false);

    canvas.addEventListener('mouseout', () => drawing = false);

    canvas.addEventListener('mousemove', draw);

    canvas.addEventListener('touchstart', () => drawing = true);

    canvas.addEventListener('touchend', () => drawing = false);

    canvas.addEventListener('touchcancel', () => drawing = false);

    canvas.addEventListener('touchmove', drawTouch);



    function draw(e) {

      if (!drawing) return;

      ctx.lineWidth = 2;

      ctx.lineCap = 'round';

      ctx.strokeStyle = '#000';

      ctx.lineTo(e.offsetX, e.offsetY);

      ctx.stroke();

      ctx.beginPath();

      ctx.moveTo(e.offsetX, e.offsetY);

    }



    function drawTouch(e) {

      e.preventDefault();

      const rect = canvas.getBoundingClientRect();

      const touch = e.touches[0];

      const x = touch.clientX - rect.left;

      const y = touch.clientY - rect.top;

      if (!drawing) return;

      ctx.lineWidth = 2;

      ctx.lineCap = 'round';

      ctx.strokeStyle = '#000';

      ctx.lineTo(x, y);

      ctx.stroke();

      ctx.beginPath();

      ctx.moveTo(x, y);

    }

  </script>

</body>

</html>
