<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>Pickup Signature</title>

  <link rel="stylesheet" href="appointment.css">

  <script src="signature.js" defer></script>

</head>

<body>

  <div class="form-container">

    <h1>Pickup Signature</h1>

    <form id="pickupForm">

      <label for="customer_name">Name:</label>

      <input type="text" id="customer_name" name="customer_name" required>



      <label for="phone">Phone:</label>

      <input type="tel" id="phone" name="phone" required>



      <label for="number_of_items">Number of Items:</label>

      <input type="number" id="number_of_items" name="number_of_items" required>



      <label for="service_type">Service Type:</label>

      <select id="service_type" name="service_type" required>

        <option value="Alteration">Alteration</option>

        <option value="Tailoring">Tailoring</option>

      </select>



      <label for="pickup_datetime">Pickup Date & Time:</label>

      <input type="datetime-local" id="pickup_datetime" name="pickup_datetime" required>



      <label for="signature-pad">Signature:</label>

      <canvas id="signature-pad" width="300" height="100" style="border:1px solid #ccc;"></canvas><br>

      <button type="button" onclick="clearSignature()">Clear</button><br><br>



      <button type="submit">Save</button>

      <button type="button" onclick="goBack()">Back</button>

    </form>

  </div>



  <script>

    const canvas = document.getElementById("signature-pad");

    const ctx = canvas.getContext("2d");

    let drawing = false;



    canvas.addEventListener("mousedown", () => drawing = true);

    canvas.addEventListener("mouseup", () => drawing = false);

    canvas.addEventListener("mouseout", () => drawing = false);

    canvas.addEventListener("mousemove", draw);



    function draw(e) {

      if (!drawing) return;

      ctx.lineWidth = 2;

      ctx.lineCap = "round";

      const rect = canvas.getBoundingClientRect();

      ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);

      ctx.stroke();

      ctx.beginPath();

      ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);

    }



    function clearSignature() {

      ctx.clearRect(0, 0, canvas.width, canvas.height);

    }



    function goBack() {

      window.history.back();

    }



    document.getElementById("pickupForm").addEventListener("submit", function (e) {

      e.preventDefault();



      const data = {

        name: document.getElementById("customer_name").value,

        phone: document.getElementById("phone").value,

        number_of_items: document.getElementById("number_of_items").value,

        service_type: document.getElementById("service_type").value,

        pickup_datetime: document.getElementById("pickup_datetime").value,

        signature: canvas.toDataURL()

      };



      fetch("https://script.google.com/macros/s/AKfycbx0ZnGDbMN5UoMp9UjDNWJ1b5LMWq-rL9aIBkJMWlcLDiKiNoXgTvB_WZn7RRXrVzXLZw/exec", {

        method: "POST",

        headers: { "Content-Type": "application/json" },

        body: JSON.stringify(data)

      })

      .then(response => response.text())

      .then(result => {

        window.location.href = "confirmation.html";

      })

      .catch(error => {

        alert("‚ùå Error while saving data.");

        console.error(error);

      });

    });

  </script>

</body>

</html>
