<!DOCTYPE html>

<html lang="en">



<head>

  <meta charset="UTF-8">

  <title>Delivery Signature</title>

  <link rel="stylesheet" href="appointment.css">

  <script src="signature.js"></script>

</head>



<body>

  <div class="form-container">

    <h1>Delivery Signature</h1>



    <form id="deliveryForm">

      <label for="customer_name">Name:</label>

      <input type="text" id="customer_name" name="customer_name" required>



      <label for="phone">Phone:</label>

      <input type="tel" id="phone" name="phone" required>



      <label for="number_of_items">Number of Items:</label>

      <input type="number" id="number_of_items" name="number_of_items" required>



      <label for="service_type">Service Type:</label>

      <select id="service_type" name="service_type" required>

        <option value="Alteration">Alteration</option>

        <option value="Tailoring">Tailoring</option>

      </select>



      <label for="delivery_datetime">Delivery Date & Time:</label>

      <input type="datetime-local" id="delivery_datetime" name="delivery_datetime" required>



      <label for="signature-pad">Signature:</label>

      <canvas id="signature-pad" width="300" height="100" style="border:1px solid #ccc;"></canvas><br>

      <button type="button" onclick="clearSignature()">Clear</button>



      <br><br>

      <button type="submit">Save</button>

      <button type="button" onclick="goBack()">Back</button>

    </form>

  </div>



  <script>

    const canvas = document.getElementById("signature-pad");

    const ctx = canvas.getContext("2d");

    let drawing = false;



    canvas.addEventListener("mousedown", () => drawing = true);

    canvas.addEventListener("mouseup", () => drawing = false);

    canvas.addEventListener("mouseout", () => drawing = false);

    canvas.addEventListener("mousemove", draw);



    function draw(e) {

      if (!drawing) return;

      ctx.lineWidth = 2;

      ctx.lineCap = "round";

      const rect = canvas.getBoundingClientRect();

      ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);

      ctx.stroke();

      ctx.beginPath();

      ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);

    }



    function clearSignature() {

      ctx.clearRect(0, 0, canvas.width, canvas.height);

    }



    function goBack() {

      window.history.back();

    }



    document.getElementById("deliveryForm").addEventListener("submit", function (e) {

      e.preventDefault();



      const formData = new FormData();

      formData.append("name", document.getElementById("customer_name").value);

      formData.append("phone", document.getElementById("phone").value);

      formData.append("number_of_items", document.getElementById("number_of_items").value);

      formData.append("service_type", document.getElementById("service_type").value);

      formData.append("delivery_datetime", document.getElementById("delivery_datetime").value);

      formData.append("signature", canvas.toDataURL());



      fetch("https://script.google.com/macros/s/AKfycbwJhxcjMtc9uV9ukpRBcIDsa2M_nKNlBJW1K2Kra7oKs0RWnWyPQ0VvYBEFL/exec", {

        method: "POST",

        body: formData

      })

        .then(res => res.text())

        .then(data => {

          alert("✔️ Delivery signature saved successfully!");

          clearSignature();

          document.getElementById("deliveryForm").reset();

        })

        .catch(err => {

          console.error("Error:", err.message);

          alert("❌ Submission failed.");

        });

    });

  </script>

</body>



</html>
